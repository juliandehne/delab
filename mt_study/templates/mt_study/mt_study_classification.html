{% extends "mt_study/mt_base.html" %}
{% load crispy_forms_tags %}
{% block content %}

    <script src="https://cdn.jsdelivr.net/npm/jdenticon@3.1.0/dist/jdenticon.min.js"></script>

    <div class="content-section">
        <legend class="section-description border-bottom mb-4">Classify this conversation</legend>
        <ol>
            <li>
                Read the conversation carefully!
            </li>
            <li>
                Make a mental note if something is not productive!
            </li>
            <li>
                Think about the topic of the conversation and whether you understand the general gist of it!
            </li>
        </ol>

        <p>The picture is a representation of the author. After that written post follows.
            The posts are a sequence of answers to the previous ones.
        </p>

        <legend class="border-bottom mb-4"></legend>

        {% for tweet in tweets %}
            {{ forloop.counter }}.
            <canvas class="identicon" data-author-id="{{ tweet.author_id }}" width="40" height="40"></canvas>
            {{ tweet.text }}
            <a href="{{ tweet.original_url }}">Link zum Nachschauen</a>
            </br>
            {% if not forloop.last %}
                <div class="vertical-line"></div>
            {% endif %}
        {% endfor %}


        <br>
        <legend class="border-bottom mb-4"></legend>
        <br>

        <legend class="border-bottom mb-4">Answer the following questions:</legend>

        <ol>
            <li>
                If unsure, don't change the default values!
            </li>
            <li>
                Pick a moderation strategy based on the reflective questions and the coding guide for the
                moderating statements!
            </li>
        </ol>

        <legend class="border-bottom mb-4"></legend>

        <form method="POST">
            {% csrf_token %}
            <fieldset class="form-group">
                {{ form|crispy }}
            </fieldset>
            <div class="form-group">
                <button id="submitButton" class="btn btn-outline-info" type="submit">Post</button>
            </div>
        </form>
    </div>

    <script type="application/javascript">
        document.addEventListener("DOMContentLoaded", function () {
            const identicons = document.querySelectorAll('.identicon');

            identicons.forEach(canvas => {
                const authorId = canvas.getAttribute('data-author-id');

                // Convert authorId to a unique string (here we just use the authorId directly)
                const hashString = authorId; // Adjust if needed

                // Render the identicon
                jdenticon.update(canvas, hashString);
            });
        });
    </script>

{% endblock content %}